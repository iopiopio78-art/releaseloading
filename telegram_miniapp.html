<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Label Release Manager</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        
        :root {
            --bg0: #0b0616;
            --bg1: #120826;
            --card: rgba(255,255,255,0.06);
            --card2: rgba(255,255,255,0.09);
            --text: #f3eaff;
            --muted: rgba(243,234,255,0.7);
            --accent: #8b5cf6;
            --accent2: #a78bfa;
            --good: #34d399;
            --warn: #fbbf24;
            --bad: #fb7185;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: radial-gradient(1200px 800px at 20% -10%, rgba(139,92,246,0.25), transparent 60%), linear-gradient(180deg, var(--bg1), var(--bg0));
            color: var(--text);
            padding-bottom: 20px;
        }



        .app {
            width: 100%;
            max-width: 1100px;
            margin: 0 auto;
        }

        @media (min-width: 900px) {
            .content { padding: 24px; }
            .nav button { font-size: 15px; }
            .card { padding: 22px; }
        }
        .header {
            background: linear-gradient(135deg, rgba(139,92,246,0.95) 0%, rgba(109,40,217,0.95) 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .nav {
            display: flex;
            background: rgba(255,255,255,0.04);
            box-shadow: 0 8px 20px rgba(0,0,0,0.35);
            overflow-x: auto;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav button {
            flex: 1;
            padding: 15px;
            border: none;
            background: rgba(255,255,255,0.04);
            color: var(--muted);
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .nav button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: 600;
        }

        .content {
            padding: 15px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .card {
            background: rgba(255,255,255,0.04);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.35);
        }

        .card h3 {
            margin-bottom: 15px;
            color: #667eea;
            font-size: 18px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 14px;
            color: var(--text);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.12);
            background: rgba(0,0,0,0.25);
            color: var(--text);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, rgba(139,92,246,0.95) 0%, rgba(109,40,217,0.95) 100%);
            color: white;
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 0 10px;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
        }

        .step::before {
            content: '';
            display: block;
            width: 30px;
            height: 30px;
            margin: 0 auto 5px;
            border-radius: 50%;
            background: #e0e0e0;
            line-height: 30px;
            font-weight: 600;
        }

        .step.active::before {
            background: #667eea;
            color: white;
            content: attr(data-step);
        }

        .step.completed::before {
            background: #4caf50;
            content: '‚úì';
            color: white;
        }

        .step span {
            font-size: 12px;
            color: var(--muted);
        }

        .step.active span,
        .step.completed span {
            color: var(--text);
            font-weight: 500;
        }

        .release-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }

        .release-item h4 {
            margin-bottom: 5px;
            color: var(--text);
        }

        .release-item p {
            font-size: 13px;
            color: var(--muted);
            margin-bottom: 3px;
        }

        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 5px;
        }

        .status-pending {
            background: rgba(251,191,36,0.18);
            color: var(--warn);
        }

        .status-approved {
            background: rgba(52,211,153,0.18);
            color: var(--good);
        }

        .status-rejected {
            background: rgba(251,113,133,0.18);
            color: var(--bad);
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 500;
            color: var(--muted);
        }

        .info-value {
            color: var(--text);
            font-weight: 600;
        }

        .tool-card {
            background: rgba(255,255,255,0.04);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.35);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .tool-card:active {
            transform: scale(0.98);
        }

        .tool-card h4 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .tool-card p {
            font-size: 13px;
            color: var(--muted);
        }

        .payment-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .payment-amount {
            font-size: 20px;
            font-weight: 700;
            color: #4caf50;
        }

        .file-upload {
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .file-upload input {
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="app">
    <div class="header">
        <h1>üéµ Label Manager</h1>
        <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ª–∏–∑–∞–º–∏ –∏ –∞—Ä—Ç–∏—Å—Ç–∞–º–∏</p>
    </div>

    <div class="nav">
        <button class="active" onclick="showSection('releases', this)">üì§ –†–µ–ª–∏–∑—ã</button>
        <button onclick="showSection('label', this)">‚ÑπÔ∏è –û –ª–µ–π–±–ª–µ</button>
        <button onclick="showSection('tools', this)">üõ† –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</button>
        <button onclick="showSection('reports', this)">üìä –û—Ç—á–µ—Ç—ã</button>
        <button onclick="showSection('payments', this)">üí∞ –í—ã–ø–ª–∞—Ç—ã</button>
    </div>

    <div class="content">
        <!-- –†–∞–∑–¥–µ–ª: –ü–æ–¥–∞—á–∞ —Ä–µ–ª–∏–∑–æ–≤ -->
        <div id="releases" class="section active">
            <div class="card">
                <h3>–ù–æ–≤—ã–π —Ä–µ–ª–∏–∑</h3>

                <div class="step-indicator">
                    <div class="step active" data-step="1">
                        <span>–û—Å–Ω–æ–≤–Ω–æ–µ</span>
                    </div>
                    <div class="step" data-step="2">
                        <span>–¢—Ä–µ–∫–∏</span>
                    </div>
                    <div class="step" data-step="3">
                        <span>–û–±–ª–æ–∂–∫–∞</span>
                    </div>
                    <div class="step" data-step="4">
                        <span>–ü—Ä–æ–≤–µ—Ä–∫–∞</span>
                    </div>
                </div>

                <div id="step1" class="form-step">
                    <div class="form-group">
                        <label>–ù–∏–∫ –∞—Ä—Ç–∏—Å—Ç–∞ *</label>
                        <input type="text" id="artistNick" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: SHADOWCAST">
                    </div>

                    <div class="form-group">
                        <label>–ò–º—è –∞—Ä—Ç–∏—Å—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                        <input type="text" id="artistName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
                    </div>

                    <div class="form-group">
                        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞ *</label>
                        <input type="text" id="releaseName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ª—å–±–æ–º–∞/—Å–∏–Ω–≥–ª–∞">
                    </div>

                    <div class="form-group">
                        <label>–¢–∏–ø —Ä–µ–ª–∏–∑–∞ *</label>
                        <select id="releaseType">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                            <option value="single">Single</option>
                            <option value="ep">EP</option>
                            <option value="album">Album</option>
                            <option value="compilation">Compilation</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–û—Å–Ω–æ–≤–Ω–æ–π –∂–∞–Ω—Ä *</label>
                        <select id="genre">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∂–∞–Ω—Ä</option>
                            <option value="witch-house">Witch House</option>
                            <option value="darkwave">Darkwave</option>
                            <option value="industrial">Industrial</option>
                            <option value="boombap">Boom Bap</option>
                            <option value="trap">Trap</option>
                            <option value="ambient">Ambient</option>
                            <option value="other">–î—Ä—É–≥–æ–π</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞ *</label>
                        <input type="date" id="releaseDate">
                    </div>

                    <button class="btn btn-primary" onclick="nextStep(2)">–î–∞–ª–µ–µ ‚Üí</button>
                </div>

                <div id="step2" class="form-step" style="display:none;">
                    <div class="form-group">
                        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–∫–æ–≤ *</label>
                        <input type="number" id="trackCount" min="1" value="1" onchange="generateTrackFields()">
                    </div>

                    <div id="trackFields"></div>

                    <button class="btn btn-primary" onclick="nextStep(3)">–î–∞–ª–µ–µ ‚Üí</button>
                </div>

                <div id="step3" class="form-step" style="display:none;">
                    <div class="form-group">
                        <label>–û–±–ª–æ–∂–∫–∞ —Ä–µ–ª–∏–∑–∞ *</label>
                        <div class="file-upload" onclick="document.getElementById('coverFile').click()">
                            <p>üìÅ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</p>
                            <p style="font-size: 12px; color: var(--muted); margin-top: 5px;">
                                JPG –∏–ª–∏ PNG, –º–∏–Ω–∏–º—É–º 3000x3000px
                            </p>
                            <input type="file" id="coverFile" accept="image/*" onchange="handleCoverUpload(event)">
                        </div>
                        <div id="coverPreview" style="margin-top: 10px;"></div>
                    </div>

                    <div class="form-group">
                        <label>–ê—É–¥–∏–æ —Ñ–∞–π–ª—ã *</label>
                        <div class="file-upload" onclick="document.getElementById('audioFiles').click()">
                            <p>üéµ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç—Ä–µ–∫–∏</p>
                            <p style="font-size: 12px; color: var(--muted); margin-top: 5px;">
                                WAV –∏–ª–∏ FLAC, 16-bit –º–∏–Ω–∏–º—É–º
                            </p>
                            <input type="file" id="audioFiles" accept="audio/*" multiple onchange="handleAudioUpload(event)">
                        </div>
                        <div id="audioList" style="margin-top: 10px;"></div>
                    </div>

                    <button class="btn btn-primary" onclick="nextStep(4)">–î–∞–ª–µ–µ ‚Üí</button>
                </div>

                <div id="step4" class="form-step" style="display:none;">
                    <h4 style="margin-bottom: 15px;">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ</h4>
                    <div id="summaryContent"></div>

                    <div class="form-group">
                        <label>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</label>
                        <textarea id="comments" placeholder="–õ—é–±–∞—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ª–µ–π–±–ª–∞"></textarea>
                    </div>

                    <button class="btn btn-primary" onclick="submitRelease()">‚úì –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–ª–∏–∑</button>
                </div>
            </div>

            <div class="card">
                <h3>–ú–æ–∏ —Ä–µ–ª–∏–∑—ã</h3>
                <div id="releasesList"></div>
            </div>
        </div>
        
        <!-- –†–∞–∑–¥–µ–ª: –û –ª–µ–π–±–ª–µ -->
        <div id="label" class="section">
            <div class="card">
                <h3>–û –Ω–∞—à–µ–º –ª–µ–π–±–ª–µ</h3>
                <p style="line-height: 1.6; margin-bottom: 15px;">
                    –ú—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º—Å—è –Ω–∞ dark electronic music: witch house, darkwave, 
                    industrial –∏ —Å–º–µ–∂–Ω—ã—Ö –∂–∞–Ω—Ä–∞—Ö. –ù–∞—à–∞ –º–∏—Å—Å–∏—è - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö 
                    –∞—Ä—Ç–∏—Å—Ç–æ–≤ –∏ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –º—É–∑—ã–∫–∏.
                </p>

                <div class="info-row">
                    <span class="info-label">–û—Å–Ω–æ–≤–∞–Ω</span>
                    <span class="info-value">2024</span>
                </div>

                <div class="info-row">
                    <span class="info-label">–ê—Ä—Ç–∏—Å—Ç–æ–≤</span>
                    <span class="info-value">24</span>
                </div>

                <div class="info-row">
                    <span class="info-label">–†–µ–ª–∏–∑–æ–≤</span>
                    <span class="info-value">87</span>
                </div>

                <div class="info-row">
                    <span class="info-label">–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã</span>
                    <span class="info-value">Spotify, Apple Music, Bandcamp</span>
                </div>
            </div>

            <div class="card">
                <h3>–£—Å–ª–æ–≤–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞</h3>
                <ul style="line-height: 1.8; padding-left: 20px;">
                    <li>–†–æ—è–ª—Ç–∏: 70% –∞—Ä—Ç–∏—Å—Ç—É, 30% –ª–µ–π–±–ª—É</li>
                    <li>–í—ã–ø–ª–∞—Ç—ã –µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ</li>
                    <li>–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –º–∞—Å—Ç–µ—Ä–∏–Ω–≥</li>
                    <li>–ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö</li>
                    <li>–†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –≤—Å–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</li>
                </ul>
            </div>

            <div class="card">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                <p style="margin-bottom: 8px;">üìß Email: label@example.com</p>
                <p style="margin-bottom: 8px;">üì± Telegram: @labelmanager</p>
                <p>üåê Website: www.label.com</p>
            </div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã -->
        <div id="tools" class="section">
            <div class="tool-card" onclick="openTool('tempo')">
                <h4>üéπ BPM Calculator</h4>
                <p>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–º–ø–∞ —Ç—Ä–µ–∫–∞</p>
            </div>

            <div class="tool-card" onclick="openTool('metadata')">
                <h4>üìù Metadata Generator</h4>
                <p>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç—Ä–µ–∫–æ–≤</p>
            </div>

            <div class="tool-card" onclick="openTool('isrc')">
                <h4>üî¢ ISRC Generator</h4>
                <p>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è ISRC –∫–æ–¥–æ–≤</p>
            </div>

            <div class="tool-card" onclick="openTool('artwork')">
                <h4>üñº Artwork Checker</h4>
                <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–ª–æ–∂–∫–∏ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º</p>
            </div>

            <div class="tool-card" onclick="openTool('mastering')">
                <h4>üéö Mastering Guide</h4>
                <p>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –º–∞—Å—Ç–µ—Ä–∏–Ω–≥—É</p>
            </div>

            <div class="tool-card" onclick="openTool('promo')">
                <h4>üì¢ Promo Kit Generator</h4>
                <p>–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ-–º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤</p>
            </div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª: –û—Ç—á–µ—Ç—ã -->
        <div id="reports" class="section">

            <div class="card">
                <h3>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <p style="line-height:1.6; color:var(--muted);">
                    –°–µ—Ä–≤–∏—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –Ω–∞–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–æ –≤—ã–ø–ª–∞—Ç—ã —Ä–æ—è–ª—Ç–∏, —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Ä–∞–∂–∞—é—Ç —á–∏—Å–ª–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π.
                </p>
                <p style="line-height:1.6; color:var(--muted); margin-top:10px;">
                    –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å —Å–µ—Ä–≤–∏—Å–æ–≤ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ, –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ (–û–ú–ê), Spotify, SoundCloud, Apple Music, Yandex.Music
                </p>
                <div style="margin-top:14px; padding:12px; border:1px solid rgba(255,255,255,0.10); border-radius:10px; background:rgba(0,0,0,0.18);">
                    <div style="font-weight:700; margin-bottom:6px; color:var(--text);">–ì—Ä–∞—Ñ–∏–∫ –ø–æ–ª–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤:</div>
                    <div style="color:var(--muted); line-height:1.7;">
                        I –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 —è–Ω–≤–∞—Ä—è –ø–æ 31 –º–∞—Ä—Ç–∞ ‚Äî –æ—Ç—á–µ—Ç—ã —Å 3 –∞–ø—Ä–µ–ª—è<br>
                        II –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 –∞–ø—Ä–µ–ª—è –ø–æ 30 –∏—é–Ω—è ‚Äî –æ—Ç—á–µ—Ç—ã —Å 3 –∏—é–ª—è<br>
                        III –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 –∏—é–ª—è –ø–æ 30 —Å–µ–Ω—Ç—è–±—Ä—è ‚Äî –æ—Ç—á–µ—Ç—ã —Å 3 –æ–∫—Ç—è–±—Ä—è<br>
                        IV –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 –æ–∫—Ç—è–±—Ä—è –ø–æ 31 –¥–µ–∫–∞–±—Ä—è ‚Äî –æ—Ç—á–µ—Ç—ã —Å 3 —è–Ω–≤–∞—Ä—è
                    </div>
                </div>
                <div style="margin-top:14px; font-weight:800; color:var(--text);">–ß—Ç–æ –¥–µ–ª–∞–µ–º? üëá</div>
            </div>

            <div class="card">
                <h3>–†–µ–ª–∏–∑—ã –≤ —Å–∏—Å—Ç–µ–º–µ</h3>
                <div class="info-row">
                    <span class="info-label">–í—Å–µ–≥–æ —Ä–µ–ª–∏–∑–æ–≤ (–≤ –±–æ—Ç–µ)</span>
                    <span class="info-value" id="totalReleasesCount">‚Äî</span>
                </div>
                <div class="info-row">
                    <span class="info-label">–í–∞—à–∏—Ö —Ä–µ–ª–∏–∑–æ–≤</span>
                    <span class="info-value" id="myReleasesCount">‚Äî</span>
                </div>
            </div>

            <div class="card">
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</h3>

                <div class="info-row">
                    <span class="info-label">–í—Å–µ–≥–æ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π</span>
                    <span class="info-value">12,847</span>
                </div>

                <div class="info-row">
                    <span class="info-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</span>
                    <span class="info-value">$127.45</span>
                </div>

                <div class="info-row">
                    <span class="info-label">–ù–æ–≤—ã–µ —Å–ª—É—à–∞—Ç–µ–ª–∏</span>
                    <span class="info-value">342</span>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" style="width: 65%;"></div>
                </div>
                <p style="font-size: 12px; color: var(--muted); margin-top: 5px;">
                    +15% –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –º–µ—Å—è—Ü—É
                </p>
            </div>

            <div class="card">
                <h3>–¢–æ–ø —Ç—Ä–µ–∫–∏</h3>

                <div class="release-item">
                    <h4>1. Void Symphony</h4>
                    <p>5,234 –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π ‚Ä¢ $52.34</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 85%;"></div>
                    </div>
                </div>

                <div class="release-item">
                    <h4>2. Midnight Ritual</h4>
                    <p>3,891 –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π ‚Ä¢ $38.91</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 63%;"></div>
                    </div>
                </div>

                <div class="release-item">
                    <h4>3. Dark Echo</h4>
                    <p>2,456 –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–π ‚Ä¢ $24.56</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 40%;"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>–ì–µ–æ–≥—Ä–∞—Ñ–∏—è —Å–ª—É—à–∞—Ç–µ–ª–µ–π</h3>
                <div class="info-row">
                    <span class="info-label">üá∑üá∫ –†–æ—Å—Å–∏—è</span>
                    <span class="info-value">42%</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üá∫üá∏ –°–®–ê</span>
                    <span class="info-value">23%</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üá©üá™ –ì–µ—Ä–º–∞–Ω–∏—è</span>
                    <span class="info-value">15%</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üá¨üáß –í–µ–ª–∏–∫–æ–±—Ä–∏—Ç–∞–Ω–∏—è</span>
                    <span class="info-value">10%</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üåç –î—Ä—É–≥–∏–µ</span>
                    <span class="info-value">10%</span>
                </div>
            </div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª: –í—ã–ø–ª–∞—Ç—ã -->
        <div id="payments" class="section">

            <div class="card">
                <h3>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –≤—ã–ø–ª–∞—Ç—ã</h3>
                <p style="line-height:1.6; color:var(--muted);">–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –æ—Ç—á–µ—Ç—ã —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª, –≤ —Å–≤—è–∑–∏ —Å —á–µ–º —Å –º–∞—Ä—Ç–∞ 2023 –≥–æ–¥–∞ –º—ã —Ç–∞–∫–∂–µ –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ –µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω—É—é –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ –≤—ã–ø–ª–∞—Ç—ã.</p>
                <p style="line-height:1.6; color:var(--muted); margin-top:10px;">–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤—ã–ø–ª–∞—Ç—ã –∏ –æ—Ç—á–µ—Ç—ã –ø–æ—Å—Ç—É–ø–∞—é—Ç 4 —Ä–∞–∑–∞ –≤ –≥–æ–¥ –≤ —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Å—è—Ü—ã: —Ñ–µ–≤—Ä–∞–ª—å (–∑–∞ –æ—Å–µ–Ω—å), –º–∞–π (–∑–∞ –∑–∏–º—É), –∞–≤–≥—É—Å—Ç (–∑–∞ –≤–µ—Å–Ω—É), –Ω–æ—è–±—Ä—å (–∑–∞ –ª–µ—Ç–æ).</p>
                <div style="margin-top:14px; padding:12px; border:1px solid rgba(255,255,255,0.10); border-radius:10px; background:rgba(0,0,0,0.18);">
                    <div style="font-weight:700; margin-bottom:6px; color:var(--text);">–ì—Ä–∞—Ñ–∏–∫ –≤—ã–ø–ª–∞—Ç:</div>
                    <div style="color:var(--muted); line-height:1.7;">
                        I –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 —è–Ω–≤–∞—Ä—è –ø–æ 31 –º–∞—Ä—Ç–∞ ‚Äî –≤—ã–ø–ª–∞—Ç—ã —Å 15 –º–∞—è<br>
                        II –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 –∞–ø—Ä–µ–ª—è –ø–æ 30 –∏—é–Ω—è ‚Äî –≤—ã–ø–ª–∞—Ç—ã —Å 15 –∞–≤–≥—É—Å—Ç–∞<br>
                        III –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 –∏—é–ª—è –ø–æ 30 —Å–µ–Ω—Ç—è–±—Ä—è ‚Äî –≤—ã–ø–ª–∞—Ç—ã —Å 15 –Ω–æ—è–±—Ä—è<br>
                        IV –∫–≤–∞—Ä—Ç–∞–ª ‚Äî —Å 1 –æ–∫—Ç—è–±—Ä—è –ø–æ 31 –¥–µ–∫–∞–±—Ä—è ‚Äî –≤—ã–ø–ª–∞—Ç—ã —Å 15 —Ñ–µ–≤—Ä–∞–ª—è
                    </div>
                </div>
                <div style="margin-top:14px; font-weight:800; color:var(--text);">–ß—Ç–æ –¥–µ–ª–∞–µ–º? üëá</div>
            </div>

            <div class="card">
                <h3>–ë–∞–ª–∞–Ω—Å</h3>
                <div style="text-align: center; padding: 20px 0;">
                    <div class="payment-amount">$127.45</div>
                    <p style="color: var(--muted); margin-top: 5px;">–î–æ—Å—Ç—É–ø–Ω–æ –∫ –≤—ã–≤–æ–¥—É</p>
                    <button class="btn btn-primary" style="margin-top: 15px; max-width: 200px; margin-left: auto; margin-right: auto;" onclick="openPayoutModal()">
                        –ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É
                    </button>
                </div>
            </div>

            <div class="card">
                <h3>–ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç</h3>

                <div class="payment-item">
                    <div>
                        <h4 style="margin-bottom: 3px;">–Ø–Ω–≤–∞—Ä—å 2026</h4>
                        <p style="font-size: 12px; color: var(--muted);">15.01.2026</p>
                    </div>
                    <div class="payment-amount" style="font-size: 18px;">$98.20</div>
                </div>

                <div class="payment-item">
                    <div>
                        <h4 style="margin-bottom: 3px;">–û–∫—Ç—è–±—Ä—å 2025</h4>
                        <p style="font-size: 12px; color: var(--muted);">15.10.2025</p>
                    </div>
                    <div class="payment-amount" style="font-size: 18px;">$76.50</div>
                </div>

                <div class="payment-item">
                    <div>
                        <h4 style="margin-bottom: 3px;">–ò—é–ª—å 2025</h4>
                        <p style="font-size: 12px; color: var(--muted);">15.07.2025</p>
                    </div>
                    <div class="payment-amount" style="font-size: 18px;">$64.30</div>
                </div>
            </div>

            <div class="card">
                <h3>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Ö–æ–¥–æ–≤</h3>
                <div class="info-row">
                    <span class="info-label">Spotify</span>
                    <span class="info-value">$67.20</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Apple Music</span>
                    <span class="info-value">$34.15</span>
                </div>
                <div class="info-row">
                    <span class="info-label">YouTube Music</span>
                    <span class="info-value">$18.50</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Bandcamp</span>
                    <span class="info-value">$7.60</span>
                </div>
            </div>
        </div>
    </div>

    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞: –£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–ª–∏–∑–∞ -->
    <div id="deleteModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55); z-index:9999; padding:16px;">
        <div class="card" style="max-width:720px; margin:10vh auto 0;">
            <h3>–£–¥–∞–ª–µ–Ω–∏–µ —Ä–µ–ª–∏–∑–∞</h3>
            <div class="form-group">
                <label>–ù–∏–∫ –∞—Ä—Ç–∏—Å—Ç–∞ *</label>
                <input type="text" id="deleteArtistNick" placeholder="–ù–∏–∫ –∞—Ä—Ç–∏—Å—Ç–∞" readonly>
            </div>
            <div class="form-group">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞ *</label>
                <input type="text" id="deleteReleaseName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞" readonly>
            </div>
            <div class="form-group">
                <label>–ü—Ä–∏—á–∏–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è *</label>
                <textarea id="deleteReason" placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É —É–¥–∞–ª–µ–Ω–∏—è"></textarea>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn" style="background:rgba(255,255,255,0.08); color:var(--text);" onclick="closeDeleteModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="confirmDeleteRelease()">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞: –ó–∞–ø—Ä–æ—Å –≤—ã–ø–ª–∞—Ç—ã -->
    <div id="payoutModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55); z-index:9999; padding:16px;">
        <div class="card" style="max-width:720px; margin:10vh auto 0;">
            <h3>–ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É</h3>
            <p style="color:var(--muted); margin-bottom:12px; line-height:1.45;">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–ª–∏–∑—ã, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–≤–æ–¥. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–µ–ª–∏–∑–æ–≤.</p>
            <div id="payoutReleaseChecklist" style="max-height:40vh; overflow:auto; padding-right:6px;"></div>
            <div class="form-group" style="margin-top:12px;">
                <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                <textarea id="payoutComment" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∫—É–¥–∞ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å, —Ä–µ–∫–≤–∏–∑–∏—Ç—ã, –ø—Ä–∏–º–µ—á–∞–Ω–∏—è"></textarea>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="btn" style="background:rgba(255,255,255,0.08); color:var(--text);" onclick="closePayoutModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" onclick="submitPayoutRequest()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</button>
            </div>
        </div>
    </div>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText('–ì–æ—Ç–æ–≤–æ');

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã Telegram
        document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#ffffff');
        document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#000000');

        let currentStep = 1;
        let releaseData = {};

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
        function showSection(sectionId, btnEl) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));

            document.getElementById(sectionId).classList.add('active');
            (btnEl || event?.target)?.classList.add('active');
        }

        // –ü–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ —Ñ–æ—Ä–º—ã
        function nextStep(step) {
            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞
            if (currentStep === 1) {
                const artistNick = document.getElementById('artistNick').value;
                const artistName = document.getElementById('artistName').value;
                const releaseName = document.getElementById('releaseName').value;
                const releaseType = document.getElementById('releaseType').value;
                const genre = document.getElementById('genre').value;
                const releaseDate = document.getElementById('releaseDate').value;

                if (!artistNick || !releaseName || !releaseType || !genre || !releaseDate) {
                    tg.showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
                    return;
                }

                releaseData.artistNick = artistNick;
                releaseData.artistName = artistName;
                releaseData.releaseName = releaseName;
                releaseData.releaseType = releaseType;
                releaseData.genre = genre;
                releaseData.releaseDate = releaseDate;
            }

            // –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π —à–∞–≥
            document.getElementById('step' + currentStep).style.display = 'none';
            document.querySelectorAll('.step')[currentStep - 1].classList.remove('active');
            document.querySelectorAll('.step')[currentStep - 1].classList.add('completed');

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
            currentStep = step;
            document.getElementById('step' + step).style.display = 'block';
            document.querySelectorAll('.step')[step - 1].classList.add('active');

            if (step === 2) {
                generateTrackFields();
            } else if (step === 4) {
                generateSummary();
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–µ–π –¥–ª—è —Ç—Ä–µ–∫–æ–≤
        function generateTrackFields() {
            const count = parseInt(document.getElementById('trackCount').value);
            const container = document.getElementById('trackFields');
            container.innerHTML = '';

            for (let i = 1; i <= count; i++) {
                container.innerHTML += `
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <h4 style="margin-bottom: 10px; color: #667eea;">–¢—Ä–µ–∫ ${i}</h4>
                        <div class="form-group">
                            <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</label>
                            <input type="text" id="track${i}Name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
                        </div>
                        <div class="form-group">
                            <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–º:—Å—Å)</label>
                            <input type="text" id="track${i}Duration" placeholder="03:45">
                        </div>
                        <div class="form-group">
                            <label>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</label>
                            <input type="text" id="track${i}Features" placeholder="feat. Artist (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">
                        </div>
                    </div>
                `;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–±–ª–æ–∂–∫–∏
        function handleCoverUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('coverPreview').innerHTML = 
                        `<img src="${e.target.result}" style="width: 100%; max-width: 300px; border-radius: 8px;">`;
                };
                reader.readAsDataURL(file);
                releaseData.cover = file.name;
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ
        function handleAudioUpload(event) {
            const files = event.target.files;
            let html = '<div style="background: #f8f9fa; padding: 10px; border-radius: 8px;">';
            for (let file of files) {
                html += `<p style="margin: 5px 0;">üéµ ${file.name}</p>`;
            }
            html += '</div>';
            document.getElementById('audioList').innerHTML = html;
            releaseData.audioFiles = Array.from(files).map(f => f.name);
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏—Ç–æ–≥–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        function generateSummary() {
            const tracks = parseInt(document.getElementById('trackCount').value);
            let tracksHtml = '';

            for (let i = 1; i <= tracks; i++) {
                const name = document.getElementById(`track${i}Name`)?.value || `–¢—Ä–µ–∫ ${i}`;
                tracksHtml += `<p style="margin: 5px 0; padding-left: 15px;">‚Ä¢ ${name}</p>`;
            }

            document.getElementById('summaryContent').innerHTML = `
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <div class="info-row">
                        <span class="info-label">–ê—Ä—Ç–∏—Å—Ç</span>
                        <span class="info-value">${releaseData.artistName}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–†–µ–ª–∏–∑</span>
                        <span class="info-value">${releaseData.releaseName}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–¢–∏–ø</span>
                        <span class="info-value">${releaseData.releaseType}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–ñ–∞–Ω—Ä</span>
                        <span class="info-value">${releaseData.genre}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞</span>
                        <span class="info-value">${releaseData.releaseDate}</span>
                    </div>
                </div>
                <h4 style="margin: 15px 0 10px;">–¢—Ä–µ–∫–∏:</h4>
                ${tracksHtml}
            `;
        }

        function resetFormToStep1() {
            // reset steps UI
            document.querySelectorAll('.form-step').forEach((el, idx) => { el.style.display = (idx===0 ? 'block' : 'none'); });
            document.querySelectorAll('.step').forEach((s, i) => {
                s.classList.remove('active');
                s.classList.remove('completed');
                if (i===0) s.classList.add('active');
            });
            currentStep = 1;
            // clear fields
            ['artistNick','artistName','releaseName','releaseType','genre','releaseDate','comments'].forEach(id => {
                const el = document.getElementById(id); if (el) el.value = '';
            });
            const tc = document.getElementById('trackCount'); if (tc) tc.value = 1;
            document.getElementById('trackFields').innerHTML = '';
            document.getElementById('coverPreview').innerHTML = '';
            document.getElementById('audioList').innerHTML = '';
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–ª–∏–∑–∞
        function submitRelease() {
            releaseData.comments = document.getElementById('comments').value;
            releaseData.id = releaseData.id || (Date.now().toString(36) + Math.random().toString(36).slice(2,8));
            releaseData.submittedAt = new Date().toLocaleDateString('ru-RU');
            releaseData.status = 'pending';

            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ (–¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ '–ú–æ–∏ —Ä–µ–ª–∏–∑—ã')
            releases.unshift({
                id: releaseData.id,
                artistNick: releaseData.artistNick,
                releaseName: releaseData.releaseName,
                submittedAt: releaseData.submittedAt,
                status: releaseData.status
            });
            saveReleases();
            renderReleases();
            renderCounts();

            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
            tg.sendData(JSON.stringify({
                action: 'submit_release',
                data: releaseData
            }));

            tg.showAlert('–†–µ–ª–∏–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 2-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.');

            // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
            // –ù–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –Ω–µ —Ç–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            resetFormToStep1();
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
        function openTool(toolName) {
            tg.showAlert(`–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç "${toolName}" –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è!`);
        }

        // –ó–∞–ø—Ä–æ—Å –≤—ã–ø–ª–∞—Ç—ã
        function requestPayout() {
            tg.showConfirm('–ó–∞–ø—Ä–æ—Å–∏—Ç—å –≤—ã–ø–ª–∞—Ç—É $127.45?', (confirmed) => {
                if (confirmed) {
                    tg.sendData(JSON.stringify({
                        action: 'request_payout',
                        amount: 127.45
                    }));
                    tg.showAlert('–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø–ª–∞—Ç—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
                }
            });
        }


        // ===== Storage & Rendering =====
        const LS_KEY = 'label_manager_releases_v1';
        let releases = [];
        let deleteTargetId = null;

        function loadReleases() {
            try {
                releases = JSON.parse(localStorage.getItem(LS_KEY) || '[]');
            } catch (e) {
                releases = [];
            }
            renderReleases();
            renderCounts();
        }

        function saveReleases() {
            localStorage.setItem(LS_KEY, JSON.stringify(releases));
        }

        function escapeHtml(s) {
            return String(s || '').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
        }

        function renderReleases() {
            const list = document.getElementById('releasesList');
            if (!list) return;
            if (!releases.length) {
                list.innerHTML = '<p style="color:var(--muted); line-height:1.5;">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–ª–∏–∑–æ–≤. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –≤—ã—à–µ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Ä–µ–ª–∏–∑ ‚Äî –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å.</p>';
                return;
            }
            list.innerHTML = releases.map(r => {
                const statusClass = r.status === 'approved' ? 'status-approved' : (r.status === 'rejected' ? 'status-rejected' : 'status-pending');
                const statusText = r.status === 'approved' ? '–û–¥–æ–±—Ä–µ–Ω–æ' : (r.status === 'rejected' ? '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ' : '–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏');
                return `
                    <div class="release-item">
                        <div style="display:flex; justify-content:space-between; gap:10px; align-items:flex-start;">
                            <div style="min-width:0;">
                                <h4 style="word-break:break-word;">${escapeHtml(r.releaseName)}</h4>
                                <p>–ù–∏–∫: ${escapeHtml(r.artistNick)}</p>
                                <p>–î–∞—Ç–∞ –ø–æ–¥–∞—á–∏: ${escapeHtml(r.submittedAt || '')}</p>
                                <span class="status ${statusClass}">${statusText}</span>
                            </div>
                            <button class="btn" style="width:auto; padding:10px 12px; background:rgba(251,113,133,0.14); color:var(--bad); border:1px solid rgba(251,113,133,0.25);" onclick="openDeleteModal('${r.id}')">–£–¥–∞–ª–∏—Ç—å</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderCounts() {
            const myCountEl = document.getElementById('myReleasesCount');
            if (myCountEl) myCountEl.textContent = String(releases.length);
        }

        // request counts from bot (global)
        function requestGlobalCounts() {
            try {
                tg.sendData(JSON.stringify({ action: 'get_counts' }));
            } catch (e) {}
        }

        // ===== Delete flow =====
        function openDeleteModal(releaseId) {
            const r = releases.find(x => x.id === releaseId);
            if (!r) return;
            deleteTargetId = releaseId;
            document.getElementById('deleteArtistNick').value = r.artistNick || '';
            document.getElementById('deleteReleaseName').value = r.releaseName || '';
            document.getElementById('deleteReason').value = '';
            document.getElementById('deleteModal').style.display = 'block';
        }

        function closeDeleteModal() {
            deleteTargetId = null;
            document.getElementById('deleteModal').style.display = 'none';
        }

        function confirmDeleteRelease() {
            const reason = document.getElementById('deleteReason').value.trim();
            if (!reason) {
                tg.showAlert('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É —É–¥–∞–ª–µ–Ω–∏—è');
                return;
            }
            const r = releases.find(x => x.id === deleteTargetId);
            if (!r) {
                closeDeleteModal();
                return;
            }

            // Notify admin via bot
            tg.sendData(JSON.stringify({
                action: 'delete_release',
                data: {
                    release_id: r.id,
                    artist_nick: r.artistNick,
                    release_name: r.releaseName,
                    reason
                }
            }));

            // Remove locally
            releases = releases.filter(x => x.id !== deleteTargetId);
            saveReleases();
            renderReleases();
            renderCounts();
            closeDeleteModal();
            tg.showAlert('–ó–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω—É.');
        }

        // ===== Payout flow =====
        function openPayoutModal() {
            const modal = document.getElementById('payoutModal');
            const list = document.getElementById('payoutReleaseChecklist');
            if (!modal || !list) return;

            if (!releases.length) {
                list.innerHTML = '<p style="color:var(--muted);">–ù–µ—Ç —Ä–µ–ª–∏–∑–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞.</p>';
            } else {
                list.innerHTML = releases.map(r => `
                    <label style="display:flex; gap:10px; align-items:flex-start; padding:10px; border:1px solid rgba(255,255,255,0.10); border-radius:10px; margin-bottom:10px; background:rgba(0,0,0,0.18);">
                        <input type="checkbox" value="${r.id}" style="margin-top:4px;">
                        <div>
                            <div style="font-weight:700; color:var(--text);">${escapeHtml(r.releaseName)}</div>
                            <div style="color:var(--muted); font-size:13px;">–ù–∏–∫: ${escapeHtml(r.artistNick)}</div>
                        </div>
                    </label>
                `).join('');
            }

            document.getElementById('payoutComment').value = '';
            modal.style.display = 'block';
        }

        function closePayoutModal() {
            document.getElementById('payoutModal').style.display = 'none';
        }

        function submitPayoutRequest() {
            const checked = Array.from(document.querySelectorAll('#payoutReleaseChecklist input[type=checkbox]:checked')).map(x => x.value);
            if (!checked.length) {
                tg.showAlert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ä–µ–ª–∏–∑');
                return;
            }
            const comment = document.getElementById('payoutComment').value.trim();
            const selected = releases.filter(r => checked.includes(r.id)).map(r => ({ id: r.id, release_name: r.releaseName, artist_nick: r.artistNick }));

            tg.sendData(JSON.stringify({
                action: 'request_payout',
                data: { releases: selected, comment }
            }));

            closePayoutModal();
            tg.showAlert('–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–ø–ª–∞—Ç—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∞–¥–º–∏–Ω—É.');
        }

        // Boot
        loadReleases();
        requestGlobalCounts();

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        tg.onEvent('mainButtonClicked', function() {
            tg.close();
        });
    </script>
</body>
</html>